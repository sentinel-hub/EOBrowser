import { reprojectGeometry } from './reproject';

const originalMultiPolygon = {
  type: 'MultiPolygon',
  coordinates: [
    [
      [
        [47.4554443359375, 40.195659093364654],
        [48.1146240234375, 40.07386810509482],
        [48.3123779296875, 40.35073056591789],
        [47.823486328125, 40.50544628405211],
        [47.4554443359375, 40.195659093364654],
      ],
    ],
    [
      [
        [48.416748046875, 40.83874913796459],
        [48.7353515625, 40.83874913796459],
        [48.7353515625, 41.05864414643029],
        [48.416748046875, 41.05864414643029],
        [48.416748046875, 40.83874913796459],
      ],
    ],
    [
      [
        [49.70764160156249, 40.283716270542584],
        [49.92187499999999, 40.1452892956766],
        [49.998779296875, 40.27952566881291],
        [49.94934082031249, 40.39258071969131],
        [49.779052734375, 40.41767833585549],
        [49.74609374999999, 40.42604212826493],
        [49.70764160156249, 40.283716270542584],
      ],
    ],
  ],
};

const reprojectedMultiPolygon = {
  type: 'MultiPolygon',
  coordinates: [
    [
      [
        [5282715.898845, 4894415.795156],
        [5356095.445999, 4876682.404594],
        [5378109.310145, 4917041.155529],
        [5323686.146006, 4939666.515901],
        [5282715.898845, 4894415.795156],
      ],
    ],
    [
      [
        [5389727.738444, 4988586.214004],
        [5425194.519569, 4988586.214004],
        [5425194.519569, 5020995.513997],
        [5389727.738444, 5020995.513997],
        [5389727.738444, 4988586.214004],
      ],
    ],
    [
      [
        [5533429.35162, 4907257.215908],
        [5557277.704445, 4887077.840441],
        [5565838.651613, 4906645.719682],
        [5560335.185577, 4923156.117792],
        [5541378.802562, 4926825.095149],
        [5537709.825204, 4928048.087602],
        [5533429.35162, 4907257.215908],
      ],
    ],
  ],
};

const originalPolygon = {
  type: 'Polygon',
  coordinates: [
    [
      [12.18558038572417, 41.87527777825127],
      [12.25328720895304, 41.80237844182856],
      [12.23896056281337, 41.92406603630972],
      [11.98548340469953, 41.9358418799922],
      [12.18558038572417, 41.87527777825127],
    ],
  ],
};

const reprojectedPolygon = {
  type: 'Polygon',
  coordinates: [
    [
      [1356492.603559, 5142314.930732],
      [1364029.692644, 5131422.507164],
      [1362434.857691, 5149611.682469],
      [1334217.909522, 5151373.708474],
      [1356492.603559, 5142314.930732],
    ],
  ],
};

// issue from https://helpcenter.dataspace.copernicus.eu/hc/en-gb/community/posts/17823673386013-Tiff-is-blank
const originalUtm53s = {
  type: 'Polygon',
  coordinates: [
    [
      [133.659283, -32.14713],
      [133.737867, -32.14713],
      [133.737867, -32.089847],
      [133.659283, -32.089847],
      [133.659283, -32.14713],
    ],
  ],
};

const reprojectedUtm53s = {
  type: 'Polygon',
  coordinates: [
    [
      [373559.710505, 6442468.625251],
      [380971.34782, 6442558.218565],
      [380896.963166, 6448908.40063],
      [373480.691713, 6448818.893962],
      [373559.710505, 6442468.625251],
    ],
  ],
};

test.each([
  [originalMultiPolygon, reprojectedMultiPolygon, 'EPSG:4326', 'EPSG:3857'],
  [originalPolygon, reprojectedPolygon, 'EPSG:4326', 'EPSG:3857'],
  [originalUtm53s, reprojectedUtm53s, 'EPSG:4326', 'EPSG:32753'],
])('Test reprojectGeometry', (originalGeometry, expectedGeometry, fromProj, toProj) => {
  const reprojectedGeometry = reprojectGeometry(originalGeometry, { fromCrs: fromProj, toCrs: toProj });
  expect(reprojectedGeometry).toEqual(expectedGeometry);
});
